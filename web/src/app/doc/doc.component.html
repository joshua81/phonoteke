<doc-menu *ngIf="doc"></doc-menu>
<div *ngIf="doc" class="container w-800 pl-1 pr-1 mt-3">
  <div class="d-flex flex-column pl-0 pr-0">
    <!-- cover -->
    <div class="cover mx-auto">
      <a *ngIf="doc.type != 'podcast' && doc.spalbumid != null" 
        href="{{'https://open.spotify.com/album/' + doc.spalbumid}}" target="_blank">
        <img *ngIf="doc.coverM == null" class="cover" src="{{doc.cover}}"/>
        <img *ngIf="doc.coverM != null" class="cover" src="{{doc.coverM}}"/>
        <span class="play"></span>
      </a>
      <a *ngIf="doc.type != 'podcast' && doc.spalbumid == null && doc.spartistid != null" 
        href="{{'https://open.spotify.com/artist/' + doc.spartistid}}" target="_blank">
        <img *ngIf="doc.coverM == null" class="cover" src="{{doc.cover}}"/>
        <img *ngIf="doc.coverM != null" class="cover" src="{{doc.coverM}}"/>
        <span class="play"></span>
      </a>
      <div *ngIf="doc.type == 'podcast' || (doc.spalbumid == null && doc.spartistid == null)" (click)="loadAlbum()">
        <img *ngIf="doc.coverM == null" class="cover" src="{{doc.cover}}"/>
        <img *ngIf="doc.coverM != null" class="cover" src="{{doc.coverM}}"/>
        <span *ngIf="doc.audio" class="play"></span>
      </div>
      <h2 *ngIf="doc.type == 'album' && doc.vote && doc.vote != 10" class="vote">{{doc.vote}}</h2>
      <div *ngIf="doc.type == 'album' && doc.vote && doc.vote == 10" class="vote">
        <span class="star"></span>
      </div>
    </div>

    <!-- album -->
    <div class="d-flex flex-column bg-white mt-3">
      <div class="mx-auto">
        <a *ngIf="doc.spalbumid && doc.type != 'podcast'" class="font-weight-bold"
          [innerHTML]="doc.title" href="{{'https://open.spotify.com/album/' + doc.spalbumid}}" target="_blank">
        </a>
        <a *ngIf="doc.spalbumid && doc.type == 'podcast'" class="font-weight-bold"
          [innerHTML]="doc.title" href="{{'https://open.spotify.com/playlist/' + doc.spalbumid}}" target="_blank">
        </a>
        <h2 *ngIf="!doc.spalbumid" [innerHTML]="doc.title"></h2>
      </div>

      <!-- artist -->
      <div class="mx-auto">
        <a *ngIf="doc.spartistid"
          [innerHTML]="doc.artist" href="{{'https://open.spotify.com/artist/' + doc.spartistid}}" target="_blank">
        </a>
        <h3 *ngIf="!doc.spartistid" [innerHTML]="doc.artist"></h3>
      </div>
      
      <!-- label + authors -->
      <h3 *ngIf="doc.type == 'album' && doc.label" class="mx-auto">{{doc.label + ' | ' + doc.year + ' | ' + doc.genres}}</h3>
      <h3 *ngIf="doc.authors" class="text-muted mx-auto mb-2">di {{doc.authors}}</h3>

      <!-- source + events -->
      <div class="d-flex flex-row align-items-center mx-auto">
        <a href="{{doc.url}}" target="_blank"><img class="{{doc.source}}"></a>
        <div *ngIf="doc.artistid" class="icon ml-2" (click)="loadEvents(doc.artistid)">
          <span class="songkick"></span>
        </div>
      </div>

      <!-- content -->
      <p *ngIf="doc.review" class="text-justify mt-2 p-2" [innerHTML]="doc.review"></p>
      <app-tracks *ngIf="doc.type == 'podcast'" [tracks]="doc.tracks"></app-tracks>
    </div>

    <!-- videos + links -->
    <app-video *ngIf="doc.type != 'podcast'" [tracks]="doc.tracks" type="videos" label="Video"></app-video>
    <app-link [links]="links" type="links" label="Link"></app-link>
    <app-link [links]="otherLinks" type="otherlinks" label="Altri Link"></app-link>
  </div>
</div>

<!-- Spotify player-->
<!--div *ngIf="spotify" class="d-flex flex-row fixed-bottom" [ngStyle]="{'width':'380px'}">
  <iframe [src]='spotifyURL()' width="350" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media">
  </iframe>
  <div class="close" (click)="close($event)">
      <span class="close"></span>
  </div>
</div-->

<!-- Podcast player-->
<div *ngIf="audio" class="player d-flex flex-row fixed-bottom w-100">
  <img *ngIf="doc.coverM == null" class="cover-player" src="{{doc.cover}}"/>
  <img *ngIf="doc.coverM != null" class="cover-player" src="{{doc.coverM}}"/>
  <div class="ml-2 w-100">
    <div class="text-truncate-1 text-white font-weight-bold" [innerHTML]="doc.title"></div>
    <div class="text-truncate-1 text-white mb-2" [innerHTML]="doc.artist"></div>
    <div class="d-flex flex-row justify-content-center align-items-center w-100">
      <div class="player-time text-white text-left mr-2" [innerHTML]="audioCurrentTime"></div>
      <div (click)="backward($event)">
        <span class="player-backward"></span>
      </div>
      <div class="ml-2 mr-2" (click)="playPause($event)">
        <span *ngIf="audio.paused" class="player-play"></span>
        <span *ngIf="!audio.paused" class="player-pause"></span>
      </div>
      <div (click)="forward($event)">
        <span class="player-forward"></span>
      </div>
      <div class="player-time text-white text-right ml-2" [innerHTML]="audioDuration"></div>
    </div>
  </div>
  <div class="close" (click)="close($event)">
    <span class="close"></span>
  </div>
</div>

<!-- Events -->
<app-events [artist]="songkick"></app-events>
